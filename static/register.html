<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registration</title>
    <link rel="stylesheet" href="https://unpkg.com/bootstrap@5.3.3/dist/css/bootstrap.min.css">

</head>
<body>
    <div class="bg-light py-3 py-md-5">
        <div class="container">
            <div class="row justify-content-md-center">
                <div class="col-12 col-md-11 col-lg-8 col-xl-7 col-xxl-6">
                    <div class="bg-white p-4 p-md-5 rounded shadow-sm">
                        <div class="row">
                            <div class="col-12">
                                <div class="mb-5">
                                    <h2 class="h3">Registration</h2>
                                    <h3 class="fs-6 fw-normal text-secondary m-0">Enter your details to register</h3>
                                </div>
                            </div>
                        </div>
                        <form id="registrationForm">
                            <div class="row gy-3 gy-md-4 overflow-hidden">

                               
                                <div class="col-12">
                                    <label for="username" class="form-label">Username <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" name="username" id="username" placeholder="Username" required>
                                </div>
                                <div class=" col-12">
                                     <label for="password" class="form-label">Password<span class="text-danger">*</span></label>
                                    <input type="password" class="form-control" name="hashed_password" id="hashed_password" placeholder="password" required>
                                </div>
        
                                <div class="col-12">
                                    <label for="preferredLanguage" class="form-label">Language Preference <span class="text-danger">*</span></label>
                                    <select class="form-control" name="preferred_language" id="preferredLanguage" required>
                                        <option value="" disabled selected>Select your language</option>
                                        <option value="en">English (en)</option>
                                        <option value="ru">Russian (ru)</option>
                                        <option value="uz">Uzbek (uz)</option>
                                        <option value="es">Spanish (es)</option>
                                        <option value="it">Italian (it)</option>
                                    </select>
                                </div>
                                
                                
                             
                                <div class="col-12">
                                    <div class="d-grid">
                                        <button class="btn btn-lg btn-primary" type="submit">Sign Up</button>
                                    </div>
                                </div>
                            </div>
                        </form>
                        <div class="row">
                            <div class="col-12">
                                <hr class="mt-5 mb-4 border-secondary-subtle">
                                <p class="m-0 text-secondary text-center">Already have an account? <a href="static/login.html" class="link-primary text-decoration-none">Sign in</a></p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <script>
    document.getElementById('registrationForm').addEventListener('submit', async function(event) {
        event.preventDefault();
        
        const formData = new FormData(this);
        const data = {
            username: formData.get('username'),
            preferred_language: formData.get('preferred_language'),
            hashed_password: formData.get("hashed_password")
        };

        try {
            const response = await fetch('api/users/register/', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data),
            });

            if (response.ok) { 
                const result = await response.json();

                window.location.href = 'static/templates/search.html';
            } else {
                const errorData = await response.json();
                alert(errorData.detail || 'An error occurred during registration.');
            }
        } catch (error) {
            console.error('Error:', error);
            alert('An error occurred while submitting the form.');
        }
    });
</script>

</body>
</html>
